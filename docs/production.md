# Продакшен‑рекомендации

## WebAuthn (passkeys)
- Требуется HTTPS и корректный домен.
- `webauthn_rp_id` должен соответствовать домену приложения (RP ID).
- `webauthn_rp_origin` должен быть HTTPS‑origin того же домена.
- `webauthn_rp_name` — отображаемое имя сервиса.
- Для локальной отладки допускается `http://localhost`/`http://127.0.0.1`, в проде — только HTTPS.
- Время на серверах должно быть синхронизировано (NTP), иначе возможны ошибки WebAuthn.

## CI/CD
- Сборка: `go build ./cmd/api-server` и `go build ./cmd/radius-server`.
- Миграции запускать как отдельный шаг (`cmd/migrate`) до выката новой версии API.
- Для Kubernetes используйте `RollingUpdate` и healthchecks (`/healthz`).
- Теги образов должны быть версионными (например, `v1.44.32`) для откатов.
- Перед релизом прогонять тесты: `go test ./...`.

## Резервное копирование
- PostgreSQL: регулярные `pg_dump` с проверкой восстановления.
- Хранить бэкапы минимум N дней (настройте политику ретенции).
- Проверять восстановление на стенде (restore + `cmd/migrate`).
- Секреты и конфиги (JWT, RADIUS, FCM и др.) хранить вне репозитория и бэкапить отдельно.
